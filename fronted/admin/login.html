<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Login Trabajadores - LoopMe</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    .box {
      max-width: 400px;
      margin: auto;
      margin-top: 80px;
    }
  </style>
</head>

<body>

  <div class="box card shadow p-4">
    <h3 class="text-center">LoopMe</h3>
    <p class="text-center text-muted">Acceso Trabajadores</p>

    <div class="mb-3">
      <label>Email</label>
      <input id="email" type="email" class="form-control">
    </div>

    <div class="mb-3">
      <label>Contrase√±a</label>
      <input id="password" type="password" class="form-control">
    </div>

    <button onclick="login()" class="btn btn-dark w-100">
      Ingresar
    </button>

    <p id="msg" class="text-danger text-center mt-2"></p>
  </div>

  <script>
    function login() {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      if (email == "" || password == "") {
        document.getElementById("msg").innerHTML = "Complete los campos";
        return;
      }

      fetch("http://localhost:3000/api/auth/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
      })
        .then(res => res.json())
        .then(data => {

          console.log("RESPUESTA LOGIN ===>", data);

          if (!data.success) {
            document.getElementById("msg").innerHTML = data.message;
            return;
          }

          localStorage.setItem("token", data.token);
          localStorage.setItem("user", JSON.stringify(data.user));

          alert("Login correcto");
          window.location.href = "/admin/dashboard.html";
        });

    }
  </script>


</body>

</html>